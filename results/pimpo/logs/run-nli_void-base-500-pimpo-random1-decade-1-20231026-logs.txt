Terminal execution:  True   (sys.argv[0]:  analysis-transformers-run.py )
Arguments passed via the terminal:

pimpo    dataset
500    sample_size_train
None    sample_size_corpus
20000    sample_size_no_topic
None    sample_size_test
nli_void    method
MoritzLaurer/deberta-v3-base-zeroshot-v1    model
transformer    vectorizer
20231026    study_date
pimpo-simple    task
1    n_run
6    n_random_runs_total
random1    group_sample
True    save_outputs
decade    group_column
448    max_length
Iteration number:  0
All random seeds:  [7270  860 5390 5191 5734 6265]
Random seed for this run:  7270
deberta-v3-base-zeroshot-v
Dataset:  pimpo 

Overall label distribution per group member:
 label_text  no_topic  supportive  sceptical  neutral
decade                                              
1990            4432         271        147       72
2000           48640        2864       1114      448
2010           26928        1455        539      258
Group selected: ['2010']  for seed 7270
Sample that might be imbalanced: df_train.label_text.value_counts:
 no_topic      300
neutral        66
sceptical      66
supportive     66
Name: label_text, dtype: int64

FINAL DF_TRAIN SAMPLE (BALANCED) for group \b2010\b:
df_train.label_text.value_counts:
 no_topic      300
neutral        66
sceptical      66
supportive     66
Name: label_text, dtype: int64

For NLI: Augmenting data by adding random not_entail examples to the train set from other classes within the train set.
Length of df_train before this step is: 498.

Max augmentation can be: len(df_train) * 2 = 996. Can also be lower, if there are more entail examples than not-entail for a majority class
For NLI:  not_entail training examples were added, which leads to an augmented training dataset of length 894.
Number of hypotheses/classes:  4 

For normal test, N classifications necessary: 6792
For NLI test, N classifications necessary: 27168

Device: cuda
Map:   0%|          | 0/894 [00:00<?, ? examples/s]                                                   Map:   0%|          | 0/27168 [00:00<?, ? examples/s]Map:  15%|█▍        | 4000/27168 [00:00<00:00, 31550.12 examples/s]Map:  29%|██▉       | 8000/27168 [00:00<00:00, 32731.76 examples/s]Map:  44%|████▍     | 12000/27168 [00:00<00:00, 33387.23 examples/s]Map:  59%|█████▉    | 16000/27168 [00:00<00:00, 26451.92 examples/s]Map:  74%|███████▎  | 20000/27168 [00:00<00:00, 28805.23 examples/s]Map:  88%|████████▊ | 24000/27168 [00:00<00:00, 30587.56 examples/s]                                                                      0%|          | 0/840 [00:00<?, ?it/s]You're using a DebertaV2TokenizerFast tokenizer. Please note that with a fast tokenizer, using the `__call__` method is faster than using a method to encode the text followed by a call to the `pad` method to get a padded encoding.
  0%|          | 1/840 [00:00<01:38,  8.52it/s]  0%|          | 3/840 [00:00<01:24,  9.91it/s]  1%|          | 5/840 [00:00<01:15, 10.99it/s]  1%|          | 7/840 [00:00<01:13, 11.28it/s]  1%|          | 9/840 [00:00<01:12, 11.44it/s]  1%|▏         | 11/840 [00:00<01:11, 11.53it/s]  2%|▏         | 13/840 [00:01<01:11, 11.58it/s]  2%|▏         | 15/840 [00:01<01:11, 11.61it/s]  2%|▏         | 17/840 [00:01<01:10, 11.64it/s]  2%|▏         | 19/840 [00:01<01:10, 11.67it/s]  2%|▎         | 21/840 [00:01<01:10, 11.66it/s]  3%|▎         | 23/840 [00:02<01:11, 11.48it/s]  3%|▎         | 25/840 [00:02<01:10, 11.55it/s]  3%|▎         | 27/840 [00:02<01:10, 11.61it/s]                                                  3%|▎         | 28/840 [00:02<01:09, 11.61it/s]  3%|▎         | 29/840 [00:02<01:09, 11.61it/s]  4%|▎         | 31/840 [00:02<01:09, 11.63it/s]  4%|▍         | 33/840 [00:02<01:09, 11.66it/s]  4%|▍         | 35/840 [00:03<01:08, 11.67it/s]  4%|▍         | 37/840 [00:03<01:08, 11.68it/s]  5%|▍         | 39/840 [00:03<01:08, 11.71it/s]  5%|▍         | 41/840 [00:03<01:08, 11.70it/s]  5%|▌         | 43/840 [00:03<01:08, 11.70it/s]  5%|▌         | 45/840 [00:03<01:08, 11.67it/s]  6%|▌         | 47/840 [00:04<01:08, 11.61it/s]  6%|▌         | 49/840 [00:04<01:08, 11.58it/s]  6%|▌         | 51/840 [00:04<01:07, 11.62it/s]  6%|▋         | 53/840 [00:04<01:07, 11.65it/s]  7%|▋         | 55/840 [00:04<01:07, 11.64it/s]                                                  7%|▋         | 56/840 [00:04<01:07, 11.64it/s]  7%|▋         | 57/840 [00:04<01:07, 11.65it/s]  7%|▋         | 59/840 [00:05<01:06, 11.71it/s]  7%|▋         | 61/840 [00:05<01:06, 11.72it/s]  8%|▊         | 63/840 [00:05<01:06, 11.72it/s]  8%|▊         | 65/840 [00:05<01:06, 11.73it/s]  8%|▊         | 67/840 [00:05<01:05, 11.75it/s]  8%|▊         | 69/840 [00:05<01:05, 11.79it/s]  8%|▊         | 71/840 [00:06<01:05, 11.78it/s]  9%|▊         | 73/840 [00:06<01:05, 11.76it/s]  9%|▉         | 75/840 [00:06<01:05, 11.73it/s]  9%|▉         | 77/840 [00:06<01:05, 11.66it/s]  9%|▉         | 79/840 [00:06<01:05, 11.68it/s] 10%|▉         | 81/840 [00:06<01:04, 11.69it/s] 10%|▉         | 83/840 [00:07<01:05, 11.63it/s]                                                 10%|█         | 84/840 [00:07<01:05, 11.63it/s] 10%|█         | 85/840 [00:07<01:05, 11.61it/s] 10%|█         | 87/840 [00:07<01:04, 11.64it/s] 11%|█         | 89/840 [00:07<01:04, 11.66it/s] 11%|█         | 91/840 [00:07<01:04, 11.68it/s] 11%|█         | 93/840 [00:08<01:03, 11.69it/s] 11%|█▏        | 95/840 [00:08<01:04, 11.64it/s] 12%|█▏        | 97/840 [00:08<01:03, 11.71it/s] 12%|█▏        | 99/840 [00:08<01:03, 11.71it/s] 12%|█▏        | 101/840 [00:08<01:03, 11.64it/s] 12%|█▏        | 103/840 [00:08<01:03, 11.67it/s] 12%|█▎        | 105/840 [00:09<01:03, 11.66it/s] 13%|█▎        | 107/840 [00:09<01:02, 11.70it/s] 13%|█▎        | 109/840 [00:09<01:02, 11.71it/s] 13%|█▎        | 111/840 [00:09<01:02, 11.71it/s]                                                  13%|█▎        | 112/840 [00:09<01:02, 11.71it/s] 13%|█▎        | 113/840 [00:09<01:02, 11.67it/s] 14%|█▎        | 115/840 [00:09<01:02, 11.66it/s] 14%|█▍        | 117/840 [00:10<01:01, 11.68it/s] 14%|█▍        | 119/840 [00:10<01:01, 11.67it/s] 14%|█▍        | 121/840 [00:10<01:01, 11.65it/s] 15%|█▍        | 123/840 [00:10<01:01, 11.67it/s] 15%|█▍        | 125/840 [00:10<01:00, 11.72it/s] 15%|█▌        | 127/840 [00:10<01:01, 11.65it/s] 15%|█▌        | 129/840 [00:11<01:01, 11.64it/s] 16%|█▌        | 131/840 [00:11<01:00, 11.66it/s] 16%|█▌        | 133/840 [00:11<01:00, 11.66it/s] 16%|█▌        | 135/840 [00:11<01:00, 11.65it/s] 16%|█▋        | 137/840 [00:11<01:00, 11.66it/s] 17%|█▋        | 139/840 [00:11<01:00, 11.66it/s]                                                  17%|█▋        | 140/840 [00:12<01:00, 11.66it/s] 17%|█▋        | 141/840 [00:12<01:00, 11.60it/s] 17%|█▋        | 143/840 [00:12<00:59, 11.64it/s] 17%|█▋        | 145/840 [00:12<00:59, 11.63it/s] 18%|█▊        | 147/840 [00:12<00:59, 11.70it/s] 18%|█▊        | 149/840 [00:12<00:59, 11.71it/s] 18%|█▊        | 151/840 [00:12<00:58, 11.73it/s] 18%|█▊        | 153/840 [00:13<00:58, 11.75it/s] 18%|█▊        | 155/840 [00:13<00:58, 11.75it/s] 19%|█▊        | 157/840 [00:13<00:58, 11.75it/s] 19%|█▉        | 159/840 [00:13<00:57, 11.75it/s] 19%|█▉        | 161/840 [00:13<00:57, 11.74it/s] 19%|█▉        | 163/840 [00:13<00:57, 11.75it/s] 20%|█▉        | 165/840 [00:14<00:57, 11.75it/s] 20%|█▉        | 167/840 [00:14<00:57, 11.65it/s]                                                  20%|██        | 168/840 [00:14<00:57, 11.65it/s] 20%|██        | 169/840 [00:14<00:57, 11.72it/s] 20%|██        | 171/840 [00:14<00:57, 11.65it/s] 21%|██        | 173/840 [00:14<00:57, 11.65it/s] 21%|██        | 175/840 [00:15<00:56, 11.67it/s] 21%|██        | 177/840 [00:15<00:56, 11.66it/s] 21%|██▏       | 179/840 [00:15<00:56, 11.65it/s] 22%|██▏       | 181/840 [00:15<00:56, 11.64it/s] 22%|██▏       | 183/840 [00:15<00:56, 11.70it/s] 22%|██▏       | 185/840 [00:15<00:55, 11.71it/s] 22%|██▏       | 187/840 [00:16<00:55, 11.71it/s] 22%|██▎       | 189/840 [00:16<00:55, 11.72it/s] 23%|██▎       | 191/840 [00:16<00:55, 11.73it/s] 23%|██▎       | 193/840 [00:16<00:55, 11.73it/s] 23%|██▎       | 195/840 [00:16<00:55, 11.70it/s]                                                  23%|██▎       | 196/840 [00:16<00:55, 11.70it/s] 23%|██▎       | 197/840 [00:16<00:54, 11.72it/s] 24%|██▎       | 199/840 [00:17<00:54, 11.70it/s] 24%|██▍       | 201/840 [00:17<00:54, 11.71it/s] 24%|██▍       | 203/840 [00:17<00:54, 11.69it/s] 24%|██▍       | 205/840 [00:17<00:54, 11.62it/s] 25%|██▍       | 207/840 [00:17<00:54, 11.66it/s] 25%|██▍       | 209/840 [00:17<00:53, 11.71it/s] 25%|██▌       | 211/840 [00:18<00:53, 11.71it/s] 25%|██▌       | 213/840 [00:18<00:53, 11.76it/s] 26%|██▌       | 215/840 [00:18<00:52, 11.80it/s] 26%|██▌       | 217/840 [00:18<00:52, 11.87it/s] 26%|██▌       | 219/840 [00:18<00:52, 11.76it/s] 26%|██▋       | 221/840 [00:18<00:52, 11.73it/s] 27%|██▋       | 223/840 [00:19<00:52, 11.74it/s]                                                  27%|██▋       | 224/840 [00:19<00:52, 11.74it/s] 27%|██▋       | 225/840 [00:19<00:52, 11.69it/s] 27%|██▋       | 227/840 [00:19<00:52, 11.71it/s] 27%|██▋       | 229/840 [00:19<00:52, 11.72it/s] 28%|██▊       | 231/840 [00:19<00:51, 11.73it/s] 28%|██▊       | 233/840 [00:19<00:52, 11.66it/s] 28%|██▊       | 235/840 [00:20<00:51, 11.69it/s] 28%|██▊       | 237/840 [00:20<00:51, 11.67it/s] 28%|██▊       | 239/840 [00:20<00:51, 11.69it/s] 29%|██▊       | 241/840 [00:20<00:51, 11.68it/s] 29%|██▉       | 243/840 [00:20<00:51, 11.62it/s] 29%|██▉       | 245/840 [00:21<00:50, 11.70it/s] 29%|██▉       | 247/840 [00:21<00:50, 11.75it/s] 30%|██▉       | 249/840 [00:21<00:50, 11.78it/s] 30%|██▉       | 251/840 [00:21<00:50, 11.73it/s]                                                  30%|███       | 252/840 [00:21<00:50, 11.73it/s] 30%|███       | 253/840 [00:21<00:50, 11.72it/s] 30%|███       | 255/840 [00:21<00:49, 11.70it/s] 31%|███       | 257/840 [00:22<00:49, 11.71it/s] 31%|███       | 259/840 [00:22<00:49, 11.71it/s] 31%|███       | 261/840 [00:22<00:49, 11.71it/s] 31%|███▏      | 263/840 [00:22<00:49, 11.76it/s] 32%|███▏      | 265/840 [00:22<00:48, 11.75it/s] 32%|███▏      | 267/840 [00:22<00:48, 11.77it/s] 32%|███▏      | 269/840 [00:23<00:48, 11.77it/s] 32%|███▏      | 271/840 [00:23<00:48, 11.80it/s] 32%|███▎      | 273/840 [00:23<00:48, 11.76it/s] 33%|███▎      | 275/840 [00:23<00:48, 11.67it/s] 33%|███▎      | 277/840 [00:23<00:48, 11.69it/s] 33%|███▎      | 279/840 [00:23<00:47, 11.71it/s]                                                  33%|███▎      | 280/840 [00:23<00:47, 11.71it/s] 33%|███▎      | 281/840 [00:24<00:47, 11.70it/s] 34%|███▎      | 283/840 [00:24<00:47, 11.74it/s] 34%|███▍      | 285/840 [00:24<00:47, 11.64it/s] 34%|███▍      | 287/840 [00:24<00:47, 11.64it/s] 34%|███▍      | 289/840 [00:24<00:47, 11.66it/s] 35%|███▍      | 291/840 [00:24<00:46, 11.68it/s] 35%|███▍      | 293/840 [00:25<00:46, 11.69it/s] 35%|███▌      | 295/840 [00:25<00:46, 11.65it/s] 35%|███▌      | 297/840 [00:25<00:46, 11.72it/s] 36%|███▌      | 299/840 [00:25<00:46, 11.76it/s] 36%|███▌      | 301/840 [00:25<00:45, 11.74it/s] 36%|███▌      | 303/840 [00:25<00:45, 11.73it/s] 36%|███▋      | 305/840 [00:26<00:45, 11.70it/s] 37%|███▋      | 307/840 [00:26<00:45, 11.70it/s]                                                  37%|███▋      | 308/840 [00:26<00:45, 11.70it/s] 37%|███▋      | 309/840 [00:26<00:45, 11.60it/s] 37%|███▋      | 311/840 [00:26<00:45, 11.64it/s] 37%|███▋      | 313/840 [00:26<00:45, 11.67it/s] 38%|███▊      | 315/840 [00:26<00:44, 11.69it/s] 38%|███▊      | 317/840 [00:27<00:44, 11.70it/s] 38%|███▊      | 319/840 [00:27<00:44, 11.68it/s] 38%|███▊      | 321/840 [00:27<00:44, 11.66it/s] 38%|███▊      | 323/840 [00:27<00:44, 11.71it/s] 39%|███▊      | 325/840 [00:27<00:43, 11.71it/s] 39%|███▉      | 327/840 [00:28<00:43, 11.73it/s] 39%|███▉      | 329/840 [00:28<00:43, 11.71it/s] 39%|███▉      | 331/840 [00:28<00:43, 11.72it/s] 40%|███▉      | 333/840 [00:28<00:43, 11.73it/s] 40%|███▉      | 335/840 [00:28<00:43, 11.73it/s]                                                  40%|████      | 336/840 [00:28<00:42, 11.73it/s] 40%|████      | 337/840 [00:28<00:43, 11.68it/s] 40%|████      | 339/840 [00:29<00:42, 11.66it/s] 41%|████      | 341/840 [00:29<00:42, 11.77it/s] 41%|████      | 343/840 [00:29<00:42, 11.69it/s] 41%|████      | 345/840 [00:29<00:42, 11.63it/s] 41%|████▏     | 347/840 [00:29<00:42, 11.66it/s] 42%|████▏     | 349/840 [00:29<00:41, 11.72it/s] 42%|████▏     | 351/840 [00:30<00:41, 11.75it/s] 42%|████▏     | 353/840 [00:30<00:41, 11.73it/s] 42%|████▏     | 355/840 [00:30<00:41, 11.76it/s] 42%|████▎     | 357/840 [00:30<00:41, 11.76it/s] 43%|████▎     | 359/840 [00:30<00:40, 11.76it/s] 43%|████▎     | 361/840 [00:30<00:40, 11.74it/s] 43%|████▎     | 363/840 [00:31<00:40, 11.71it/s]                                                  43%|████▎     | 364/840 [00:31<00:40, 11.71it/s] 43%|████▎     | 365/840 [00:31<00:40, 11.75it/s] 44%|████▎     | 367/840 [00:31<00:40, 11.78it/s] 44%|████▍     | 369/840 [00:31<00:40, 11.76it/s] 44%|████▍     | 371/840 [00:31<00:39, 11.75it/s] 44%|████▍     | 373/840 [00:31<00:40, 11.67it/s] 45%|████▍     | 375/840 [00:32<00:39, 11.73it/s] 45%|████▍     | 377/840 [00:32<00:39, 11.69it/s] 45%|████▌     | 379/840 [00:32<00:39, 11.69it/s] 45%|████▌     | 381/840 [00:32<00:39, 11.67it/s] 46%|████▌     | 383/840 [00:32<00:39, 11.69it/s] 46%|████▌     | 385/840 [00:32<00:38, 11.67it/s] 46%|████▌     | 387/840 [00:33<00:38, 11.65it/s] 46%|████▋     | 389/840 [00:33<00:38, 11.67it/s] 47%|████▋     | 391/840 [00:33<00:38, 11.70it/s]                                                  47%|████▋     | 392/840 [00:33<00:38, 11.70it/s] 47%|████▋     | 393/840 [00:33<00:38, 11.74it/s] 47%|████▋     | 395/840 [00:33<00:38, 11.63it/s] 47%|████▋     | 397/840 [00:33<00:37, 11.67it/s] 48%|████▊     | 399/840 [00:34<00:37, 11.69it/s] 48%|████▊     | 401/840 [00:34<00:37, 11.70it/s] 48%|████▊     | 403/840 [00:34<00:37, 11.70it/s] 48%|████▊     | 405/840 [00:34<00:37, 11.71it/s] 48%|████▊     | 407/840 [00:34<00:36, 11.71it/s] 49%|████▊     | 409/840 [00:35<00:36, 11.67it/s] 49%|████▉     | 411/840 [00:35<00:36, 11.68it/s] 49%|████▉     | 413/840 [00:35<00:36, 11.68it/s] 49%|████▉     | 415/840 [00:35<00:36, 11.68it/s] 50%|████▉     | 417/840 [00:35<00:36, 11.73it/s] 50%|████▉     | 419/840 [00:35<00:36, 11.69it/s]                                                  50%|█████     | 420/840 [00:35<00:35, 11.69it/s] 50%|█████     | 421/840 [00:36<00:35, 11.70it/s] 50%|█████     | 423/840 [00:36<00:35, 11.71it/s] 51%|█████     | 425/840 [00:36<00:35, 11.72it/s] 51%|█████     | 427/840 [00:36<00:35, 11.68it/s] 51%|█████     | 429/840 [00:36<00:35, 11.74it/s] 51%|█████▏    | 431/840 [00:36<00:34, 11.74it/s] 52%|█████▏    | 433/840 [00:37<00:34, 11.74it/s] 52%|█████▏    | 435/840 [00:37<00:34, 11.78it/s] 52%|█████▏    | 437/840 [00:37<00:34, 11.71it/s] 52%|█████▏    | 439/840 [00:37<00:34, 11.58it/s] 52%|█████▎    | 441/840 [00:37<00:34, 11.63it/s] 53%|█████▎    | 443/840 [00:37<00:34, 11.67it/s] 53%|█████▎    | 445/840 [00:38<00:33, 11.68it/s] 53%|█████▎    | 447/840 [00:38<00:33, 11.69it/s]                                                  53%|█████▎    | 448/840 [00:38<00:33, 11.69it/s] 53%|█████▎    | 449/840 [00:38<00:33, 11.70it/s] 54%|█████▎    | 451/840 [00:38<00:33, 11.71it/s] 54%|█████▍    | 453/840 [00:38<00:32, 11.76it/s] 54%|█████▍    | 455/840 [00:38<00:32, 11.74it/s] 54%|█████▍    | 457/840 [00:39<00:32, 11.80it/s] 55%|█████▍    | 459/840 [00:39<00:32, 11.75it/s] 55%|█████▍    | 461/840 [00:39<00:32, 11.68it/s] 55%|█████▌    | 463/840 [00:39<00:32, 11.63it/s] 55%|█████▌    | 465/840 [00:39<00:32, 11.65it/s] 56%|█████▌    | 467/840 [00:39<00:31, 11.67it/s] 56%|█████▌    | 469/840 [00:40<00:31, 11.74it/s] 56%|█████▌    | 471/840 [00:40<00:31, 11.74it/s] 56%|█████▋    | 473/840 [00:40<00:31, 11.79it/s] 57%|█████▋    | 475/840 [00:40<00:30, 11.81it/s]                                                  57%|█████▋    | 476/840 [00:40<00:30, 11.81it/s] 57%|█████▋    | 477/840 [00:40<00:30, 11.78it/s] 57%|█████▋    | 479/840 [00:40<00:30, 11.81it/s] 57%|█████▋    | 481/840 [00:41<00:30, 11.79it/s] 57%|█████▊    | 483/840 [00:41<00:30, 11.70it/s] 58%|█████▊    | 485/840 [00:41<00:30, 11.69it/s] 58%|█████▊    | 487/840 [00:41<00:30, 11.75it/s] 58%|█████▊    | 489/840 [00:41<00:29, 11.75it/s] 58%|█████▊    | 491/840 [00:42<00:29, 11.79it/s] 59%|█████▊    | 493/840 [00:42<00:29, 11.67it/s] 59%|█████▉    | 495/840 [00:42<00:29, 11.70it/s] 59%|█████▉    | 497/840 [00:42<00:29, 11.71it/s] 59%|█████▉    | 499/840 [00:42<00:29, 11.68it/s] 60%|█████▉    | 501/840 [00:42<00:28, 11.69it/s] 60%|█████▉    | 503/840 [00:43<00:28, 11.67it/s]                                                  60%|██████    | 504/840 [00:43<00:28, 11.67it/s] 60%|██████    | 505/840 [00:43<00:28, 11.67it/s] 60%|██████    | 507/840 [00:43<00:28, 11.67it/s] 61%|██████    | 509/840 [00:43<00:28, 11.66it/s] 61%|██████    | 511/840 [00:43<00:28, 11.72it/s] 61%|██████    | 513/840 [00:43<00:27, 11.76it/s] 61%|██████▏   | 515/840 [00:44<00:27, 11.80it/s] 62%|██████▏   | 517/840 [00:44<00:27, 11.73it/s] 62%|██████▏   | 519/840 [00:44<00:27, 11.76it/s] 62%|██████▏   | 521/840 [00:44<00:27, 11.75it/s] 62%|██████▏   | 523/840 [00:44<00:27, 11.67it/s] 62%|██████▎   | 525/840 [00:44<00:26, 11.69it/s] 63%|██████▎   | 527/840 [00:45<00:26, 11.69it/s] 63%|██████▎   | 529/840 [00:45<00:26, 11.69it/s] 63%|██████▎   | 531/840 [00:45<00:26, 11.70it/s]                                                  63%|██████▎   | 532/840 [00:45<00:26, 11.70it/s] 63%|██████▎   | 533/840 [00:45<00:26, 11.67it/s] 64%|██████▎   | 535/840 [00:45<00:26, 11.72it/s] 64%|██████▍   | 537/840 [00:45<00:25, 11.72it/s] 64%|██████▍   | 539/840 [00:46<00:25, 11.76it/s] 64%|██████▍   | 541/840 [00:46<00:25, 11.72it/s] 65%|██████▍   | 543/840 [00:46<00:25, 11.72it/s] 65%|██████▍   | 545/840 [00:46<00:25, 11.72it/s] 65%|██████▌   | 547/840 [00:46<00:25, 11.72it/s] 65%|██████▌   | 549/840 [00:46<00:24, 11.76it/s] 66%|██████▌   | 551/840 [00:47<00:24, 11.79it/s] 66%|██████▌   | 553/840 [00:47<00:24, 11.73it/s] 66%|██████▌   | 555/840 [00:47<00:24, 11.70it/s] 66%|██████▋   | 557/840 [00:47<00:24, 11.68it/s] 67%|██████▋   | 559/840 [00:47<00:24, 11.69it/s]                                                  67%|██████▋   | 560/840 [00:47<00:23, 11.69it/s] 67%|██████▋   | 561/840 [00:47<00:23, 11.69it/s] 67%|██████▋   | 563/840 [00:48<00:23, 11.69it/s] 67%|██████▋   | 565/840 [00:48<00:23, 11.63it/s] 68%|██████▊   | 567/840 [00:48<00:23, 11.63it/s] 68%|██████▊   | 569/840 [00:48<00:23, 11.71it/s] 68%|██████▊   | 571/840 [00:48<00:22, 11.71it/s] 68%|██████▊   | 573/840 [00:49<00:22, 11.70it/s] 68%|██████▊   | 575/840 [00:49<00:22, 11.75it/s] 69%|██████▊   | 577/840 [00:49<00:22, 11.75it/s] 69%|██████▉   | 579/840 [00:49<00:22, 11.70it/s] 69%|██████▉   | 581/840 [00:49<00:22, 11.71it/s] 69%|██████▉   | 583/840 [00:49<00:21, 11.71it/s] 70%|██████▉   | 585/840 [00:50<00:21, 11.71it/s] 70%|██████▉   | 587/840 [00:50<00:21, 11.68it/s]                                                  70%|███████   | 588/840 [00:50<00:21, 11.68it/s] 70%|███████   | 589/840 [00:50<00:21, 11.73it/s] 70%|███████   | 591/840 [00:50<00:21, 11.66it/s] 71%|███████   | 593/840 [00:50<00:21, 11.68it/s] 71%|███████   | 595/840 [00:50<00:20, 11.68it/s] 71%|███████   | 597/840 [00:51<00:20, 11.72it/s] 71%|███████▏  | 599/840 [00:51<00:20, 11.76it/s] 72%|███████▏  | 601/840 [00:51<00:20, 11.79it/s] 72%|███████▏  | 603/840 [00:51<00:20, 11.76it/s] 72%|███████▏  | 605/840 [00:51<00:19, 11.80it/s] 72%|███████▏  | 607/840 [00:51<00:20, 11.61it/s] 72%|███████▎  | 609/840 [00:52<00:19, 11.65it/s] 73%|███████▎  | 611/840 [00:52<00:19, 11.66it/s] 73%|███████▎  | 613/840 [00:52<00:19, 11.65it/s] 73%|███████▎  | 615/840 [00:52<00:19, 11.67it/s]                                                  73%|███████▎  | 616/840 [00:52<00:19, 11.67it/s] 73%|███████▎  | 617/840 [00:52<00:19, 11.67it/s] 74%|███████▎  | 619/840 [00:52<00:18, 11.69it/s] 74%|███████▍  | 621/840 [00:53<00:18, 11.70it/s] 74%|███████▍  | 623/840 [00:53<00:18, 11.63it/s] 74%|███████▍  | 625/840 [00:53<00:18, 11.67it/s] 75%|███████▍  | 627/840 [00:53<00:18, 11.70it/s] 75%|███████▍  | 629/840 [00:53<00:18, 11.59it/s] 75%|███████▌  | 631/840 [00:53<00:18, 11.61it/s] 75%|███████▌  | 633/840 [00:54<00:17, 11.63it/s] 76%|███████▌  | 635/840 [00:54<00:17, 11.66it/s] 76%|███████▌  | 637/840 [00:54<00:17, 11.65it/s] 76%|███████▌  | 639/840 [00:54<00:17, 11.60it/s] 76%|███████▋  | 641/840 [00:54<00:17, 11.63it/s] 77%|███████▋  | 643/840 [00:55<00:16, 11.70it/s]                                                  77%|███████▋  | 644/840 [00:55<00:16, 11.70it/s] 77%|███████▋  | 645/840 [00:55<00:16, 11.57it/s] 77%|███████▋  | 647/840 [00:55<00:16, 11.61it/s] 77%|███████▋  | 649/840 [00:55<00:16, 11.66it/s] 78%|███████▊  | 651/840 [00:55<00:16, 11.73it/s] 78%|███████▊  | 653/840 [00:55<00:15, 11.72it/s] 78%|███████▊  | 655/840 [00:56<00:15, 11.72it/s] 78%|███████▊  | 657/840 [00:56<00:15, 11.76it/s] 78%|███████▊  | 659/840 [00:56<00:15, 11.75it/s] 79%|███████▊  | 661/840 [00:56<00:15, 11.71it/s] 79%|███████▉  | 663/840 [00:56<00:15, 11.75it/s] 79%|███████▉  | 665/840 [00:56<00:14, 11.78it/s] 79%|███████▉  | 667/840 [00:57<00:14, 11.71it/s] 80%|███████▉  | 669/840 [00:57<00:14, 11.70it/s] 80%|███████▉  | 671/840 [00:57<00:14, 11.62it/s]                                                  80%|████████  | 672/840 [00:57<00:14, 11.62it/s] 80%|████████  | 673/840 [00:57<00:14, 11.62it/s] 80%|████████  | 675/840 [00:57<00:14, 11.62it/s] 81%|████████  | 677/840 [00:57<00:13, 11.64it/s] 81%|████████  | 679/840 [00:58<00:13, 11.59it/s] 81%|████████  | 681/840 [00:58<00:13, 11.59it/s] 81%|████████▏ | 683/840 [00:58<00:13, 11.63it/s] 82%|████████▏ | 685/840 [00:58<00:13, 11.67it/s] 82%|████████▏ | 687/840 [00:58<00:13, 11.68it/s] 82%|████████▏ | 689/840 [00:58<00:12, 11.69it/s] 82%|████████▏ | 691/840 [00:59<00:12, 11.72it/s] 82%|████████▎ | 693/840 [00:59<00:12, 11.76it/s] 83%|████████▎ | 695/840 [00:59<00:12, 11.69it/s] 83%|████████▎ | 697/840 [00:59<00:12, 11.70it/s] 83%|████████▎ | 699/840 [00:59<00:12, 11.71it/s]                                                  83%|████████▎ | 700/840 [00:59<00:11, 11.71it/s] 83%|████████▎ | 701/840 [00:59<00:11, 11.68it/s] 84%|████████▎ | 703/840 [01:00<00:11, 11.67it/s] 84%|████████▍ | 705/840 [01:00<00:11, 11.69it/s] 84%|████████▍ | 707/840 [01:00<00:11, 11.69it/s] 84%|████████▍ | 709/840 [01:00<00:11, 11.75it/s] 85%|████████▍ | 711/840 [01:00<00:10, 11.73it/s] 85%|████████▍ | 713/840 [01:00<00:10, 11.72it/s] 85%|████████▌ | 715/840 [01:01<00:10, 11.72it/s] 85%|████████▌ | 717/840 [01:01<00:10, 11.68it/s] 86%|████████▌ | 719/840 [01:01<00:10, 11.69it/s] 86%|████████▌ | 721/840 [01:01<00:10, 11.71it/s] 86%|████████▌ | 723/840 [01:01<00:09, 11.76it/s] 86%|████████▋ | 725/840 [01:02<00:09, 11.73it/s] 87%|████████▋ | 727/840 [01:02<00:09, 11.72it/s]                                                  87%|████████▋ | 728/840 [01:02<00:09, 11.72it/s] 87%|████████▋ | 729/840 [01:02<00:09, 11.73it/s] 87%|████████▋ | 731/840 [01:02<00:09, 11.73it/s] 87%|████████▋ | 733/840 [01:02<00:09, 11.78it/s] 88%|████████▊ | 735/840 [01:02<00:08, 11.77it/s] 88%|████████▊ | 737/840 [01:03<00:08, 11.73it/s] 88%|████████▊ | 739/840 [01:03<00:08, 11.72it/s] 88%|████████▊ | 741/840 [01:03<00:08, 11.63it/s] 88%|████████▊ | 743/840 [01:03<00:08, 11.63it/s] 89%|████████▊ | 745/840 [01:03<00:08, 11.63it/s] 89%|████████▉ | 747/840 [01:03<00:07, 11.69it/s] 89%|████████▉ | 749/840 [01:04<00:07, 11.69it/s] 89%|████████▉ | 751/840 [01:04<00:07, 11.71it/s] 90%|████████▉ | 753/840 [01:04<00:07, 11.71it/s] 90%|████████▉ | 755/840 [01:04<00:07, 11.64it/s]                                                  90%|█████████ | 756/840 [01:04<00:07, 11.64it/s] 90%|█████████ | 757/840 [01:04<00:07, 11.66it/s] 90%|█████████ | 759/840 [01:04<00:06, 11.67it/s] 91%|█████████ | 761/840 [01:05<00:06, 11.68it/s] 91%|█████████ | 763/840 [01:05<00:06, 11.66it/s] 91%|█████████ | 765/840 [01:05<00:06, 11.64it/s] 91%|█████████▏| 767/840 [01:05<00:06, 11.66it/s] 92%|█████████▏| 769/840 [01:05<00:06, 11.60it/s] 92%|█████████▏| 771/840 [01:05<00:05, 11.63it/s] 92%|█████████▏| 773/840 [01:06<00:05, 11.70it/s] 92%|█████████▏| 775/840 [01:06<00:05, 11.63it/s] 92%|█████████▎| 777/840 [01:06<00:05, 11.64it/s] 93%|█████████▎| 779/840 [01:06<00:05, 11.70it/s] 93%|█████████▎| 781/840 [01:06<00:05, 11.79it/s] 93%|█████████▎| 783/840 [01:06<00:04, 11.81it/s]                                                  93%|█████████▎| 784/840 [01:07<00:04, 11.81it/s] 93%|█████████▎| 785/840 [01:07<00:04, 11.78it/s] 94%|█████████▎| 787/840 [01:07<00:04, 11.76it/s] 94%|█████████▍| 789/840 [01:07<00:04, 11.75it/s] 94%|█████████▍| 791/840 [01:07<00:04, 11.71it/s] 94%|█████████▍| 793/840 [01:07<00:03, 11.76it/s] 95%|█████████▍| 795/840 [01:08<00:03, 11.79it/s] 95%|█████████▍| 797/840 [01:08<00:03, 11.75it/s] 95%|█████████▌| 799/840 [01:08<00:03, 11.75it/s] 95%|█████████▌| 801/840 [01:08<00:03, 11.84it/s] 96%|█████████▌| 803/840 [01:08<00:03, 11.80it/s] 96%|█████████▌| 805/840 [01:08<00:02, 11.78it/s] 96%|█████████▌| 807/840 [01:09<00:02, 11.82it/s] 96%|█████████▋| 809/840 [01:09<00:02, 11.78it/s] 97%|█████████▋| 811/840 [01:09<00:02, 11.69it/s]                                                  97%|█████████▋| 812/840 [01:09<00:02, 11.69it/s] 97%|█████████▋| 813/840 [01:09<00:02, 11.63it/s] 97%|█████████▋| 815/840 [01:09<00:02, 11.67it/s] 97%|█████████▋| 817/840 [01:09<00:01, 11.70it/s] 98%|█████████▊| 819/840 [01:10<00:01, 11.71it/s] 98%|█████████▊| 821/840 [01:10<00:01, 11.72it/s] 98%|█████████▊| 823/840 [01:10<00:01, 11.73it/s] 98%|█████████▊| 825/840 [01:10<00:01, 11.72it/s] 98%|█████████▊| 827/840 [01:10<00:01, 11.65it/s] 99%|█████████▊| 829/840 [01:10<00:00, 11.66it/s] 99%|█████████▉| 831/840 [01:11<00:00, 11.68it/s] 99%|█████████▉| 833/840 [01:11<00:00, 11.68it/s] 99%|█████████▉| 835/840 [01:11<00:00, 11.69it/s]100%|█████████▉| 837/840 [01:11<00:00, 11.70it/s]100%|█████████▉| 839/840 [01:11<00:00, 11.71it/s]                                                 100%|██████████| 840/840 [01:11<00:00, 11.71it/s]                                                 100%|██████████| 840/840 [01:11<00:00, 11.71it/s]100%|██████████| 840/840 [01:11<00:00, 11.69it/s]
{'loss': 2.4327, 'learning_rate': 3.0952380952380957e-06, 'epoch': 1.0}
{'loss': 0.8449, 'learning_rate': 6.4285714285714295e-06, 'epoch': 2.0}
{'loss': 0.6955, 'learning_rate': 9.761904761904762e-06, 'epoch': 3.0}
{'loss': 0.6684, 'learning_rate': 1.3095238095238096e-05, 'epoch': 4.0}
{'loss': 0.5865, 'learning_rate': 1.642857142857143e-05, 'epoch': 5.0}
{'loss': 0.4962, 'learning_rate': 1.9761904761904763e-05, 'epoch': 6.0}
{'loss': 0.4182, 'learning_rate': 1.922619047619048e-05, 'epoch': 7.0}
{'loss': 0.2834, 'learning_rate': 1.8392857142857142e-05, 'epoch': 8.0}
{'loss': 0.2039, 'learning_rate': 1.755952380952381e-05, 'epoch': 9.0}
{'loss': 0.157, 'learning_rate': 1.672619047619048e-05, 'epoch': 10.0}
{'loss': 0.1312, 'learning_rate': 1.5892857142857142e-05, 'epoch': 11.0}
{'loss': 0.1058, 'learning_rate': 1.5059523809523811e-05, 'epoch': 12.0}
{'loss': 0.056, 'learning_rate': 1.4226190476190478e-05, 'epoch': 13.0}
{'loss': 0.0659, 'learning_rate': 1.3392857142857142e-05, 'epoch': 14.0}
{'loss': 0.07, 'learning_rate': 1.2559523809523811e-05, 'epoch': 15.0}
{'loss': 0.0153, 'learning_rate': 1.1726190476190478e-05, 'epoch': 16.0}
{'loss': 0.0421, 'learning_rate': 1.0922619047619047e-05, 'epoch': 17.0}
{'loss': 0.026, 'learning_rate': 1.0089285714285714e-05, 'epoch': 18.0}
{'loss': 0.0267, 'learning_rate': 9.255952380952381e-06, 'epoch': 19.0}
{'loss': 0.0199, 'learning_rate': 8.422619047619049e-06, 'epoch': 20.0}
{'loss': 0.0194, 'learning_rate': 7.589285714285714e-06, 'epoch': 21.0}
{'loss': 0.0043, 'learning_rate': 6.755952380952382e-06, 'epoch': 22.0}
{'loss': 0.0078, 'learning_rate': 5.922619047619048e-06, 'epoch': 23.0}
{'loss': 0.0032, 'learning_rate': 5.0892857142857146e-06, 'epoch': 24.0}
{'loss': 0.0105, 'learning_rate': 4.255952380952381e-06, 'epoch': 25.0}
{'loss': 0.0098, 'learning_rate': 3.422619047619048e-06, 'epoch': 26.0}
{'loss': 0.029, 'learning_rate': 2.5892857142857148e-06, 'epoch': 27.0}
{'loss': 0.0018, 'learning_rate': 1.755952380952381e-06, 'epoch': 28.0}
{'loss': 0.0098, 'learning_rate': 9.226190476190477e-07, 'epoch': 29.0}
{'loss': 0.0044, 'learning_rate': 8.928571428571429e-08, 'epoch': 30.0}
{'train_runtime': 71.8471, 'train_samples_per_second': 373.293, 'train_steps_per_second': 11.691, 'train_loss': 0.24818777657513108, 'epoch': 30.0}

Train time: 71.93848609924316 

  0%|          | 0/107 [00:00<?, ?it/s]  2%|▏         | 2/107 [00:00<00:05, 19.00it/s]  4%|▎         | 4/107 [00:00<00:08, 11.54it/s]  6%|▌         | 6/107 [00:00<00:09, 10.16it/s]  7%|▋         | 8/107 [00:00<00:10,  9.83it/s]  9%|▉         | 10/107 [00:00<00:09, 10.13it/s] 11%|█         | 12/107 [00:01<00:09,  9.77it/s] 13%|█▎        | 14/107 [00:01<00:09, 10.07it/s] 15%|█▍        | 16/107 [00:01<00:09,  9.70it/s] 17%|█▋        | 18/107 [00:01<00:08, 10.16it/s] 19%|█▊        | 20/107 [00:01<00:08,  9.76it/s] 20%|█▉        | 21/107 [00:02<00:08,  9.68it/s] 21%|██▏       | 23/107 [00:02<00:08,  9.72it/s] 23%|██▎       | 25/107 [00:02<00:08,  9.89it/s] 24%|██▍       | 26/107 [00:02<00:10,  7.98it/s] 25%|██▌       | 27/107 [00:02<00:10,  7.93it/s] 26%|██▌       | 28/107 [00:02<00:09,  8.30it/s] 28%|██▊       | 30/107 [00:03<00:08,  8.82it/s] 29%|██▉       | 31/107 [00:03<00:08,  8.88it/s] 30%|██▉       | 32/107 [00:03<00:08,  8.97it/s] 31%|███       | 33/107 [00:03<00:08,  8.59it/s] 32%|███▏      | 34/107 [00:03<00:08,  8.48it/s] 33%|███▎      | 35/107 [00:03<00:08,  8.80it/s] 34%|███▎      | 36/107 [00:03<00:07,  9.01it/s] 35%|███▍      | 37/107 [00:03<00:07,  9.02it/s] 36%|███▌      | 38/107 [00:04<00:07,  8.84it/s] 36%|███▋      | 39/107 [00:04<00:07,  8.67it/s] 37%|███▋      | 40/107 [00:04<00:08,  8.32it/s] 38%|███▊      | 41/107 [00:04<00:07,  8.35it/s] 40%|████      | 43/107 [00:04<00:07,  9.00it/s] 41%|████      | 44/107 [00:04<00:06,  9.08it/s] 43%|████▎     | 46/107 [00:04<00:06,  9.37it/s] 44%|████▍     | 47/107 [00:05<00:06,  9.38it/s] 46%|████▌     | 49/107 [00:05<00:06,  9.62it/s] 47%|████▋     | 50/107 [00:05<00:06,  9.49it/s] 48%|████▊     | 51/107 [00:05<00:05,  9.59it/s] 50%|████▉     | 53/107 [00:05<00:05,  9.82it/s] 51%|█████▏    | 55/107 [00:05<00:05,  9.66it/s] 52%|█████▏    | 56/107 [00:05<00:05,  9.44it/s] 53%|█████▎    | 57/107 [00:06<00:05,  9.31it/s] 54%|█████▍    | 58/107 [00:06<00:05,  9.10it/s] 55%|█████▌    | 59/107 [00:06<00:05,  9.27it/s] 56%|█████▌    | 60/107 [00:06<00:05,  9.32it/s] 57%|█████▋    | 61/107 [00:06<00:04,  9.20it/s] 58%|█████▊    | 62/107 [00:06<00:04,  9.24it/s] 59%|█████▉    | 63/107 [00:06<00:04,  8.99it/s] 60%|█████▉    | 64/107 [00:06<00:04,  8.67it/s] 61%|██████    | 65/107 [00:07<00:04,  8.51it/s] 62%|██████▏   | 66/107 [00:07<00:04,  8.60it/s] 64%|██████▎   | 68/107 [00:07<00:04,  9.55it/s] 64%|██████▍   | 69/107 [00:07<00:04,  9.31it/s] 65%|██████▌   | 70/107 [00:07<00:04,  7.63it/s] 66%|██████▋   | 71/107 [00:07<00:04,  8.02it/s] 67%|██████▋   | 72/107 [00:07<00:04,  8.28it/s] 68%|██████▊   | 73/107 [00:07<00:04,  7.90it/s] 70%|███████   | 75/107 [00:08<00:03,  9.13it/s] 71%|███████   | 76/107 [00:08<00:03,  8.62it/s] 72%|███████▏  | 77/107 [00:08<00:03,  8.92it/s] 73%|███████▎  | 78/107 [00:08<00:03,  9.09it/s] 74%|███████▍  | 79/107 [00:08<00:03,  9.26it/s] 75%|███████▍  | 80/107 [00:08<00:03,  8.72it/s] 77%|███████▋  | 82/107 [00:08<00:02,  9.62it/s] 79%|███████▊  | 84/107 [00:09<00:02,  9.46it/s] 80%|████████  | 86/107 [00:09<00:02,  9.66it/s] 81%|████████▏ | 87/107 [00:09<00:02,  9.69it/s] 82%|████████▏ | 88/107 [00:09<00:01,  9.74it/s] 83%|████████▎ | 89/107 [00:09<00:02,  8.81it/s] 84%|████████▍ | 90/107 [00:09<00:01,  8.84it/s] 85%|████████▌ | 91/107 [00:09<00:01,  8.35it/s] 86%|████████▌ | 92/107 [00:10<00:01,  8.70it/s] 88%|████████▊ | 94/107 [00:10<00:01,  9.69it/s] 89%|████████▉ | 95/107 [00:10<00:01,  9.55it/s] 90%|████████▉ | 96/107 [00:10<00:01,  9.60it/s] 91%|█████████ | 97/107 [00:10<00:01,  9.56it/s] 92%|█████████▏| 98/107 [00:10<00:00,  9.63it/s] 93%|█████████▎| 99/107 [00:10<00:00,  9.24it/s] 93%|█████████▎| 100/107 [00:10<00:00,  9.05it/s] 94%|█████████▍| 101/107 [00:10<00:00,  9.06it/s] 95%|█████████▌| 102/107 [00:11<00:00,  8.76it/s] 97%|█████████▋| 104/107 [00:11<00:00,  8.92it/s] 99%|█████████▉| 106/107 [00:11<00:00,  9.39it/s]100%|██████████| 107/107 [00:11<00:00,  9.13it/s]
Highest probability prediction per premise:  [2, 0, 0, 0, 2, 3, 0, 0, 0, 0, 2, 0, 2, 0, 0, 3, 0, 1, 0, 3]
Correct labels per premise:  [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]
Aggregate metrics:  {'f1_macro': 0.44607869533248035, 'f1_micro': 0.681095406360424, 'accuracy_balanced': 0.5005834421269905, 'accuracy_not_b': 0.681095406360424, 'precision_macro': 0.4614241493366902, 'recall_macro': 0.5005834421269905, 'precision_micro': 0.681095406360424, 'recall_micro': 0.681095406360424}
Detailed metrics:  {'neutral': {'precision': 0.07445887445887446, 'recall': 0.441025641025641, 'f1-score': 0.1274074074074074, 'support': 195}, 'no_topic': {'precision': 0.9404442274835245, 'recall': 0.7706, 'f1-score': 0.8470924480598, 'support': 5000}, 'sceptical': {'precision': 0.3506172839506173, 'recall': 0.31555555555555553, 'f1-score': 0.3321637426900585, 'support': 450}, 'supportive': {'precision': 0.4801762114537445, 'recall': 0.47515257192676547, 'f1-score': 0.47765118317265554, 'support': 1147}, 'accuracy': 0.681095406360424, 'macro avg': {'precision': 0.4614241493366902, 'recall': 0.5005834421269905, 'f1-score': 0.44607869533248035, 'support': 6792}, 'weighted avg': {'precision': 0.7987751045718972, 'recall': 0.681095406360424, 'f1-score': 0.7299243633764735, 'support': 6792}} 


Test results:
{'eval_loss': 2.6213502883911133, 'eval_f1_macro': 0.44607869533248035, 'eval_f1_micro': 0.681095406360424, 'eval_accuracy_balanced': 0.5005834421269905, 'eval_accuracy_not_b': 0.681095406360424, 'eval_precision_macro': 0.4614241493366902, 'eval_recall_macro': 0.5005834421269905, 'eval_precision_micro': 0.681095406360424, 'eval_recall_micro': 0.681095406360424, 'eval_runtime': 11.8404, 'eval_samples_per_second': 2294.52, 'eval_steps_per_second': 9.037, 'epoch': 30.0}

Script done.


