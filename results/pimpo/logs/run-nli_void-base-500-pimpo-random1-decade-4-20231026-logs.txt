Terminal execution:  True   (sys.argv[0]:  analysis-transformers-run.py )
Arguments passed via the terminal:

pimpo    dataset
500    sample_size_train
None    sample_size_corpus
20000    sample_size_no_topic
None    sample_size_test
nli_void    method
MoritzLaurer/deberta-v3-base-zeroshot-v1    model
transformer    vectorizer
20231026    study_date
pimpo-simple    task
4    n_run
6    n_random_runs_total
random1    group_sample
True    save_outputs
decade    group_column
448    max_length
Iteration number:  3
All random seeds:  [7270  860 5390 5191 5734 6265]
Random seed for this run:  5191
deberta-v3-base-zeroshot-v
Dataset:  pimpo 

Overall label distribution per group member:
 label_text  no_topic  supportive  sceptical  neutral
decade                                              
1990            4432         271        147       72
2000           48640        2864       1114      448
2010           26928        1455        539      258
Group selected: ['2010']  for seed 5191
Sample that might be imbalanced: df_train.label_text.value_counts:
 no_topic      300
neutral        66
sceptical      66
supportive     66
Name: label_text, dtype: int64

FINAL DF_TRAIN SAMPLE (BALANCED) for group \b2010\b:
df_train.label_text.value_counts:
 no_topic      300
neutral        66
sceptical      66
supportive     66
Name: label_text, dtype: int64

For NLI: Augmenting data by adding random not_entail examples to the train set from other classes within the train set.
Length of df_train before this step is: 498.

Max augmentation can be: len(df_train) * 2 = 996. Can also be lower, if there are more entail examples than not-entail for a majority class
For NLI:  not_entail training examples were added, which leads to an augmented training dataset of length 894.
Number of hypotheses/classes:  4 

For normal test, N classifications necessary: 6792
For NLI test, N classifications necessary: 27168

Device: cuda
Map:   0%|          | 0/894 [00:00<?, ? examples/s]                                                   Map:   0%|          | 0/27168 [00:00<?, ? examples/s]Map:  15%|█▍        | 4000/27168 [00:00<00:00, 31583.14 examples/s]Map:  29%|██▉       | 8000/27168 [00:00<00:00, 32708.83 examples/s]Map:  44%|████▍     | 12000/27168 [00:00<00:00, 33287.61 examples/s]Map:  59%|█████▉    | 16000/27168 [00:00<00:00, 26232.64 examples/s]Map:  74%|███████▎  | 20000/27168 [00:00<00:00, 28724.96 examples/s]Map:  88%|████████▊ | 24000/27168 [00:00<00:00, 30527.11 examples/s]                                                                      0%|          | 0/840 [00:00<?, ?it/s]You're using a DebertaV2TokenizerFast tokenizer. Please note that with a fast tokenizer, using the `__call__` method is faster than using a method to encode the text followed by a call to the `pad` method to get a padded encoding.
  0%|          | 1/840 [00:00<01:36,  8.71it/s]  0%|          | 2/840 [00:00<01:31,  9.18it/s]  0%|          | 4/840 [00:00<01:15, 11.03it/s]  1%|          | 6/840 [00:00<01:14, 11.26it/s]  1%|          | 8/840 [00:00<01:13, 11.35it/s]  1%|          | 10/840 [00:00<01:12, 11.38it/s]  1%|▏         | 12/840 [00:01<01:12, 11.39it/s]  2%|▏         | 14/840 [00:01<01:11, 11.51it/s]  2%|▏         | 16/840 [00:01<01:11, 11.45it/s]  2%|▏         | 18/840 [00:01<01:11, 11.45it/s]  2%|▏         | 20/840 [00:01<01:11, 11.51it/s]  3%|▎         | 22/840 [00:01<01:11, 11.51it/s]  3%|▎         | 24/840 [00:02<01:10, 11.56it/s]  3%|▎         | 26/840 [00:02<01:10, 11.53it/s]  3%|▎         | 28/840 [00:02<01:10, 11.57it/s]                                                  3%|▎         | 28/840 [00:02<01:10, 11.57it/s]  4%|▎         | 30/840 [00:02<01:10, 11.48it/s]  4%|▍         | 32/840 [00:02<01:10, 11.51it/s]  4%|▍         | 34/840 [00:02<01:10, 11.47it/s]  4%|▍         | 36/840 [00:03<01:10, 11.46it/s]  5%|▍         | 38/840 [00:03<01:09, 11.52it/s]  5%|▍         | 40/840 [00:03<01:08, 11.60it/s]  5%|▌         | 42/840 [00:03<01:09, 11.53it/s]  5%|▌         | 44/840 [00:03<01:08, 11.58it/s]  5%|▌         | 46/840 [00:04<01:07, 11.68it/s]  6%|▌         | 48/840 [00:04<01:07, 11.73it/s]  6%|▌         | 50/840 [00:04<01:07, 11.65it/s]  6%|▌         | 52/840 [00:04<01:07, 11.61it/s]  6%|▋         | 54/840 [00:04<01:07, 11.61it/s]  7%|▋         | 56/840 [00:04<01:07, 11.62it/s]                                                  7%|▋         | 56/840 [00:04<01:07, 11.62it/s]  7%|▋         | 58/840 [00:05<01:07, 11.57it/s]  7%|▋         | 60/840 [00:05<01:07, 11.60it/s]  7%|▋         | 62/840 [00:05<01:06, 11.67it/s]  8%|▊         | 64/840 [00:05<01:07, 11.55it/s]  8%|▊         | 66/840 [00:05<01:07, 11.52it/s]  8%|▊         | 68/840 [00:05<01:06, 11.57it/s]  8%|▊         | 70/840 [00:06<01:06, 11.52it/s]  9%|▊         | 72/840 [00:06<01:06, 11.57it/s]  9%|▉         | 74/840 [00:06<01:06, 11.59it/s]  9%|▉         | 76/840 [00:06<01:06, 11.55it/s]  9%|▉         | 78/840 [00:06<01:05, 11.67it/s] 10%|▉         | 80/840 [00:06<01:05, 11.62it/s] 10%|▉         | 82/840 [00:07<01:05, 11.58it/s] 10%|█         | 84/840 [00:07<01:04, 11.64it/s]                                                 10%|█         | 84/840 [00:07<01:04, 11.64it/s] 10%|█         | 86/840 [00:07<01:04, 11.64it/s] 10%|█         | 88/840 [00:07<01:04, 11.66it/s] 11%|█         | 90/840 [00:07<01:04, 11.67it/s] 11%|█         | 92/840 [00:07<01:04, 11.62it/s] 11%|█         | 94/840 [00:08<01:04, 11.57it/s] 11%|█▏        | 96/840 [00:08<01:04, 11.58it/s] 12%|█▏        | 98/840 [00:08<01:04, 11.57it/s] 12%|█▏        | 100/840 [00:08<01:03, 11.63it/s] 12%|█▏        | 102/840 [00:08<01:03, 11.54it/s] 12%|█▏        | 104/840 [00:09<01:03, 11.52it/s] 13%|█▎        | 106/840 [00:09<01:03, 11.51it/s] 13%|█▎        | 108/840 [00:09<01:03, 11.49it/s] 13%|█▎        | 110/840 [00:09<01:03, 11.47it/s] 13%|█▎        | 112/840 [00:09<01:02, 11.61it/s]                                                  13%|█▎        | 112/840 [00:09<01:02, 11.61it/s] 14%|█▎        | 114/840 [00:09<01:02, 11.60it/s] 14%|█▍        | 116/840 [00:10<01:02, 11.59it/s] 14%|█▍        | 118/840 [00:10<01:02, 11.61it/s] 14%|█▍        | 120/840 [00:10<01:01, 11.62it/s] 15%|█▍        | 122/840 [00:10<01:02, 11.56it/s] 15%|█▍        | 124/840 [00:10<01:01, 11.59it/s] 15%|█▌        | 126/840 [00:10<01:01, 11.54it/s] 15%|█▌        | 128/840 [00:11<01:01, 11.50it/s] 15%|█▌        | 130/840 [00:11<01:01, 11.56it/s] 16%|█▌        | 132/840 [00:11<01:01, 11.54it/s] 16%|█▌        | 134/840 [00:11<01:01, 11.51it/s] 16%|█▌        | 136/840 [00:11<01:00, 11.55it/s] 16%|█▋        | 138/840 [00:11<01:01, 11.47it/s] 17%|█▋        | 140/840 [00:12<01:01, 11.46it/s]                                                  17%|█▋        | 140/840 [00:12<01:01, 11.46it/s] 17%|█▋        | 142/840 [00:12<01:00, 11.47it/s] 17%|█▋        | 144/840 [00:12<01:00, 11.45it/s] 17%|█▋        | 146/840 [00:12<01:00, 11.45it/s] 18%|█▊        | 148/840 [00:12<01:00, 11.50it/s] 18%|█▊        | 150/840 [00:13<01:00, 11.49it/s] 18%|█▊        | 152/840 [00:13<00:59, 11.54it/s] 18%|█▊        | 154/840 [00:13<00:59, 11.52it/s] 19%|█▊        | 156/840 [00:13<00:59, 11.59it/s] 19%|█▉        | 158/840 [00:13<00:58, 11.61it/s] 19%|█▉        | 160/840 [00:13<00:58, 11.61it/s] 19%|█▉        | 162/840 [00:14<00:58, 11.54it/s] 20%|█▉        | 164/840 [00:14<00:58, 11.62it/s] 20%|█▉        | 166/840 [00:14<00:57, 11.67it/s] 20%|██        | 168/840 [00:14<00:57, 11.65it/s]                                                  20%|██        | 168/840 [00:14<00:57, 11.65it/s] 20%|██        | 170/840 [00:14<00:57, 11.63it/s] 20%|██        | 172/840 [00:14<00:57, 11.62it/s] 21%|██        | 174/840 [00:15<00:57, 11.51it/s] 21%|██        | 176/840 [00:15<00:57, 11.49it/s] 21%|██        | 178/840 [00:15<00:57, 11.51it/s] 21%|██▏       | 180/840 [00:15<00:57, 11.50it/s] 22%|██▏       | 182/840 [00:15<00:56, 11.55it/s] 22%|██▏       | 184/840 [00:15<00:56, 11.52it/s] 22%|██▏       | 186/840 [00:16<00:56, 11.52it/s] 22%|██▏       | 188/840 [00:16<00:56, 11.56it/s] 23%|██▎       | 190/840 [00:16<00:56, 11.59it/s] 23%|██▎       | 192/840 [00:16<00:55, 11.61it/s] 23%|██▎       | 194/840 [00:16<00:55, 11.55it/s] 23%|██▎       | 196/840 [00:16<00:55, 11.57it/s]                                                  23%|██▎       | 196/840 [00:16<00:55, 11.57it/s] 24%|██▎       | 198/840 [00:17<00:55, 11.58it/s] 24%|██▍       | 200/840 [00:17<00:55, 11.54it/s] 24%|██▍       | 202/840 [00:17<00:55, 11.45it/s] 24%|██▍       | 204/840 [00:17<00:55, 11.44it/s] 25%|██▍       | 206/840 [00:17<00:55, 11.40it/s] 25%|██▍       | 208/840 [00:18<00:55, 11.43it/s] 25%|██▌       | 210/840 [00:18<00:54, 11.50it/s] 25%|██▌       | 212/840 [00:18<00:54, 11.54it/s] 25%|██▌       | 214/840 [00:18<00:54, 11.52it/s] 26%|██▌       | 216/840 [00:18<00:53, 11.60it/s] 26%|██▌       | 218/840 [00:18<00:53, 11.61it/s] 26%|██▌       | 220/840 [00:19<00:53, 11.58it/s] 26%|██▋       | 222/840 [00:19<00:53, 11.60it/s] 27%|██▋       | 224/840 [00:19<00:52, 11.66it/s]                                                  27%|██▋       | 224/840 [00:19<00:52, 11.66it/s] 27%|██▋       | 226/840 [00:19<00:52, 11.60it/s] 27%|██▋       | 228/840 [00:19<00:52, 11.56it/s] 27%|██▋       | 230/840 [00:19<00:52, 11.53it/s] 28%|██▊       | 232/840 [00:20<00:52, 11.57it/s] 28%|██▊       | 234/840 [00:20<00:52, 11.61it/s] 28%|██▊       | 236/840 [00:20<00:51, 11.62it/s] 28%|██▊       | 238/840 [00:20<00:51, 11.60it/s] 29%|██▊       | 240/840 [00:20<00:51, 11.55it/s] 29%|██▉       | 242/840 [00:20<00:51, 11.53it/s] 29%|██▉       | 244/840 [00:21<00:51, 11.57it/s] 29%|██▉       | 246/840 [00:21<00:51, 11.53it/s] 30%|██▉       | 248/840 [00:21<00:51, 11.56it/s] 30%|██▉       | 250/840 [00:21<00:50, 11.58it/s] 30%|███       | 252/840 [00:21<00:50, 11.63it/s]                                                  30%|███       | 252/840 [00:21<00:50, 11.63it/s] 30%|███       | 254/840 [00:22<00:50, 11.57it/s] 30%|███       | 256/840 [00:22<00:50, 11.51it/s] 31%|███       | 258/840 [00:22<00:50, 11.59it/s] 31%|███       | 260/840 [00:22<00:49, 11.61it/s] 31%|███       | 262/840 [00:22<00:49, 11.65it/s] 31%|███▏      | 264/840 [00:22<00:49, 11.55it/s] 32%|███▏      | 266/840 [00:23<00:49, 11.54it/s] 32%|███▏      | 268/840 [00:23<00:49, 11.58it/s] 32%|███▏      | 270/840 [00:23<00:49, 11.54it/s] 32%|███▏      | 272/840 [00:23<00:49, 11.46it/s] 33%|███▎      | 274/840 [00:23<00:49, 11.51it/s] 33%|███▎      | 276/840 [00:23<00:49, 11.49it/s] 33%|███▎      | 278/840 [00:24<00:48, 11.59it/s] 33%|███▎      | 280/840 [00:24<00:48, 11.65it/s]                                                  33%|███▎      | 280/840 [00:24<00:48, 11.65it/s] 34%|███▎      | 282/840 [00:24<00:47, 11.68it/s] 34%|███▍      | 284/840 [00:24<00:47, 11.60it/s] 34%|███▍      | 286/840 [00:24<00:47, 11.57it/s] 34%|███▍      | 288/840 [00:24<00:47, 11.65it/s] 35%|███▍      | 290/840 [00:25<00:47, 11.55it/s] 35%|███▍      | 292/840 [00:25<00:47, 11.53it/s] 35%|███▌      | 294/840 [00:25<00:47, 11.56it/s] 35%|███▌      | 296/840 [00:25<00:46, 11.58it/s] 35%|███▌      | 298/840 [00:25<00:46, 11.61it/s] 36%|███▌      | 300/840 [00:25<00:46, 11.57it/s] 36%|███▌      | 302/840 [00:26<00:46, 11.52it/s] 36%|███▌      | 304/840 [00:26<00:46, 11.51it/s] 36%|███▋      | 306/840 [00:26<00:46, 11.53it/s] 37%|███▋      | 308/840 [00:26<00:46, 11.49it/s]                                                  37%|███▋      | 308/840 [00:26<00:46, 11.49it/s] 37%|███▋      | 310/840 [00:26<00:46, 11.42it/s] 37%|███▋      | 312/840 [00:27<00:46, 11.37it/s] 37%|███▋      | 314/840 [00:27<00:46, 11.36it/s] 38%|███▊      | 316/840 [00:27<00:46, 11.36it/s] 38%|███▊      | 318/840 [00:27<00:45, 11.46it/s] 38%|███▊      | 320/840 [00:27<00:45, 11.50it/s] 38%|███▊      | 322/840 [00:27<00:44, 11.54it/s] 39%|███▊      | 324/840 [00:28<00:44, 11.58it/s] 39%|███▉      | 326/840 [00:28<00:44, 11.65it/s] 39%|███▉      | 328/840 [00:28<00:43, 11.65it/s] 39%|███▉      | 330/840 [00:28<00:43, 11.65it/s] 40%|███▉      | 332/840 [00:28<00:43, 11.66it/s] 40%|███▉      | 334/840 [00:28<00:43, 11.61it/s] 40%|████      | 336/840 [00:29<00:43, 11.66it/s]                                                  40%|████      | 336/840 [00:29<00:43, 11.66it/s] 40%|████      | 338/840 [00:29<00:43, 11.59it/s] 40%|████      | 340/840 [00:29<00:43, 11.61it/s] 41%|████      | 342/840 [00:29<00:43, 11.56it/s] 41%|████      | 344/840 [00:29<00:42, 11.59it/s] 41%|████      | 346/840 [00:29<00:42, 11.61it/s] 41%|████▏     | 348/840 [00:30<00:42, 11.47it/s] 42%|████▏     | 350/840 [00:30<00:42, 11.52it/s] 42%|████▏     | 352/840 [00:30<00:42, 11.55it/s] 42%|████▏     | 354/840 [00:30<00:42, 11.51it/s] 42%|████▏     | 356/840 [00:30<00:41, 11.54it/s] 43%|████▎     | 358/840 [00:31<00:41, 11.52it/s] 43%|████▎     | 360/840 [00:31<00:41, 11.52it/s] 43%|████▎     | 362/840 [00:31<00:41, 11.56it/s] 43%|████▎     | 364/840 [00:31<00:40, 11.63it/s]                                                  43%|████▎     | 364/840 [00:31<00:40, 11.63it/s] 44%|████▎     | 366/840 [00:31<00:40, 11.58it/s] 44%|████▍     | 368/840 [00:31<00:40, 11.64it/s] 44%|████▍     | 370/840 [00:32<00:40, 11.64it/s] 44%|████▍     | 372/840 [00:32<00:40, 11.64it/s] 45%|████▍     | 374/840 [00:32<00:40, 11.64it/s] 45%|████▍     | 376/840 [00:32<00:39, 11.61it/s] 45%|████▌     | 378/840 [00:32<00:40, 11.49it/s] 45%|████▌     | 380/840 [00:32<00:39, 11.52it/s] 45%|████▌     | 382/840 [00:33<00:39, 11.50it/s] 46%|████▌     | 384/840 [00:33<00:39, 11.49it/s] 46%|████▌     | 386/840 [00:33<00:39, 11.58it/s] 46%|████▌     | 388/840 [00:33<00:38, 11.60it/s] 46%|████▋     | 390/840 [00:33<00:39, 11.50it/s] 47%|████▋     | 392/840 [00:33<00:38, 11.53it/s]                                                  47%|████▋     | 392/840 [00:33<00:38, 11.53it/s] 47%|████▋     | 394/840 [00:34<00:38, 11.56it/s] 47%|████▋     | 396/840 [00:34<00:38, 11.62it/s] 47%|████▋     | 398/840 [00:34<00:37, 11.67it/s] 48%|████▊     | 400/840 [00:34<00:38, 11.54it/s] 48%|████▊     | 402/840 [00:34<00:38, 11.50it/s] 48%|████▊     | 404/840 [00:34<00:38, 11.47it/s] 48%|████▊     | 406/840 [00:35<00:37, 11.44it/s] 49%|████▊     | 408/840 [00:35<00:37, 11.50it/s] 49%|████▉     | 410/840 [00:35<00:37, 11.54it/s] 49%|████▉     | 412/840 [00:35<00:36, 11.57it/s] 49%|████▉     | 414/840 [00:35<00:36, 11.58it/s] 50%|████▉     | 416/840 [00:36<00:36, 11.60it/s] 50%|████▉     | 418/840 [00:36<00:36, 11.59it/s] 50%|█████     | 420/840 [00:36<00:36, 11.61it/s]                                                  50%|█████     | 420/840 [00:36<00:36, 11.61it/s] 50%|█████     | 422/840 [00:36<00:36, 11.53it/s] 50%|█████     | 424/840 [00:36<00:36, 11.55it/s] 51%|█████     | 426/840 [00:36<00:36, 11.48it/s] 51%|█████     | 428/840 [00:37<00:35, 11.47it/s] 51%|█████     | 430/840 [00:37<00:35, 11.51it/s] 51%|█████▏    | 432/840 [00:37<00:35, 11.54it/s] 52%|█████▏    | 434/840 [00:37<00:35, 11.49it/s] 52%|█████▏    | 436/840 [00:37<00:35, 11.48it/s] 52%|█████▏    | 438/840 [00:37<00:34, 11.52it/s] 52%|█████▏    | 440/840 [00:38<00:34, 11.59it/s] 53%|█████▎    | 442/840 [00:38<00:34, 11.54it/s] 53%|█████▎    | 444/840 [00:38<00:34, 11.54it/s] 53%|█████▎    | 446/840 [00:38<00:34, 11.56it/s] 53%|█████▎    | 448/840 [00:38<00:33, 11.58it/s]                                                  53%|█████▎    | 448/840 [00:38<00:33, 11.58it/s] 54%|█████▎    | 450/840 [00:38<00:33, 11.55it/s] 54%|█████▍    | 452/840 [00:39<00:33, 11.55it/s] 54%|█████▍    | 454/840 [00:39<00:33, 11.53it/s] 54%|█████▍    | 456/840 [00:39<00:33, 11.54it/s] 55%|█████▍    | 458/840 [00:39<00:33, 11.57it/s] 55%|█████▍    | 460/840 [00:39<00:32, 11.55it/s] 55%|█████▌    | 462/840 [00:40<00:32, 11.54it/s] 55%|█████▌    | 464/840 [00:40<00:32, 11.49it/s] 55%|█████▌    | 466/840 [00:40<00:32, 11.39it/s] 56%|█████▌    | 468/840 [00:40<00:32, 11.44it/s] 56%|█████▌    | 470/840 [00:40<00:32, 11.47it/s] 56%|█████▌    | 472/840 [00:40<00:32, 11.44it/s] 56%|█████▋    | 474/840 [00:41<00:32, 11.39it/s] 57%|█████▋    | 476/840 [00:41<00:31, 11.42it/s]                                                  57%|█████▋    | 476/840 [00:41<00:31, 11.42it/s] 57%|█████▋    | 478/840 [00:41<00:31, 11.34it/s] 57%|█████▋    | 480/840 [00:41<00:31, 11.32it/s] 57%|█████▋    | 482/840 [00:41<00:31, 11.25it/s] 58%|█████▊    | 484/840 [00:41<00:31, 11.33it/s] 58%|█████▊    | 486/840 [00:42<00:31, 11.32it/s] 58%|█████▊    | 488/840 [00:42<00:31, 11.34it/s] 58%|█████▊    | 490/840 [00:42<00:30, 11.40it/s] 59%|█████▊    | 492/840 [00:42<00:30, 11.39it/s] 59%|█████▉    | 494/840 [00:42<00:30, 11.38it/s] 59%|█████▉    | 496/840 [00:43<00:30, 11.43it/s] 59%|█████▉    | 498/840 [00:43<00:29, 11.47it/s] 60%|█████▉    | 500/840 [00:43<00:29, 11.45it/s] 60%|█████▉    | 502/840 [00:43<00:29, 11.45it/s] 60%|██████    | 504/840 [00:43<00:29, 11.51it/s]                                                  60%|██████    | 504/840 [00:43<00:29, 11.51it/s] 60%|██████    | 506/840 [00:43<00:29, 11.44it/s] 60%|██████    | 508/840 [00:44<00:29, 11.42it/s] 61%|██████    | 510/840 [00:44<00:28, 11.46it/s] 61%|██████    | 512/840 [00:44<00:28, 11.53it/s] 61%|██████    | 514/840 [00:44<00:28, 11.52it/s] 61%|██████▏   | 516/840 [00:44<00:28, 11.51it/s] 62%|██████▏   | 518/840 [00:44<00:28, 11.49it/s] 62%|██████▏   | 520/840 [00:45<00:27, 11.54it/s] 62%|██████▏   | 522/840 [00:45<00:27, 11.48it/s] 62%|██████▏   | 524/840 [00:45<00:27, 11.44it/s] 63%|██████▎   | 526/840 [00:45<00:27, 11.40it/s] 63%|██████▎   | 528/840 [00:45<00:27, 11.40it/s] 63%|██████▎   | 530/840 [00:45<00:27, 11.40it/s] 63%|██████▎   | 532/840 [00:46<00:26, 11.45it/s]                                                  63%|██████▎   | 532/840 [00:46<00:26, 11.45it/s] 64%|██████▎   | 534/840 [00:46<00:26, 11.42it/s] 64%|██████▍   | 536/840 [00:46<00:26, 11.51it/s] 64%|██████▍   | 538/840 [00:46<00:26, 11.41it/s] 64%|██████▍   | 540/840 [00:46<00:26, 11.44it/s] 65%|██████▍   | 542/840 [00:47<00:26, 11.41it/s] 65%|██████▍   | 544/840 [00:47<00:25, 11.42it/s] 65%|██████▌   | 546/840 [00:47<00:25, 11.42it/s] 65%|██████▌   | 548/840 [00:47<00:25, 11.39it/s] 65%|██████▌   | 550/840 [00:47<00:25, 11.44it/s] 66%|██████▌   | 552/840 [00:47<00:25, 11.48it/s] 66%|██████▌   | 554/840 [00:48<00:24, 11.71it/s] 66%|██████▌   | 556/840 [00:48<00:24, 11.71it/s] 66%|██████▋   | 558/840 [00:48<00:24, 11.67it/s] 67%|██████▋   | 560/840 [00:48<00:24, 11.56it/s]                                                  67%|██████▋   | 560/840 [00:48<00:24, 11.56it/s] 67%|██████▋   | 562/840 [00:48<00:24, 11.50it/s] 67%|██████▋   | 564/840 [00:48<00:24, 11.46it/s] 67%|██████▋   | 566/840 [00:49<00:23, 11.45it/s] 68%|██████▊   | 568/840 [00:49<00:23, 11.48it/s] 68%|██████▊   | 570/840 [00:49<00:23, 11.50it/s] 68%|██████▊   | 572/840 [00:49<00:23, 11.52it/s] 68%|██████▊   | 574/840 [00:49<00:23, 11.53it/s] 69%|██████▊   | 576/840 [00:49<00:22, 11.48it/s] 69%|██████▉   | 578/840 [00:50<00:22, 11.44it/s] 69%|██████▉   | 580/840 [00:50<00:22, 11.40it/s] 69%|██████▉   | 582/840 [00:50<00:22, 11.39it/s] 70%|██████▉   | 584/840 [00:50<00:22, 11.44it/s] 70%|██████▉   | 586/840 [00:50<00:22, 11.34it/s] 70%|███████   | 588/840 [00:51<00:22, 11.40it/s]                                                  70%|███████   | 588/840 [00:51<00:22, 11.40it/s] 70%|███████   | 590/840 [00:51<00:21, 11.38it/s] 70%|███████   | 592/840 [00:51<00:21, 11.38it/s] 71%|███████   | 594/840 [00:51<00:21, 11.44it/s] 71%|███████   | 596/840 [00:51<00:21, 11.48it/s] 71%|███████   | 598/840 [00:51<00:21, 11.41it/s] 71%|███████▏  | 600/840 [00:52<00:20, 11.43it/s] 72%|███████▏  | 602/840 [00:52<00:20, 11.42it/s] 72%|███████▏  | 604/840 [00:52<00:20, 11.50it/s] 72%|███████▏  | 606/840 [00:52<00:20, 11.51it/s] 72%|███████▏  | 608/840 [00:52<00:20, 11.43it/s] 73%|███████▎  | 610/840 [00:52<00:20, 11.46it/s] 73%|███████▎  | 612/840 [00:53<00:19, 11.49it/s] 73%|███████▎  | 614/840 [00:53<00:19, 11.46it/s] 73%|███████▎  | 616/840 [00:53<00:19, 11.50it/s]                                                  73%|███████▎  | 616/840 [00:53<00:19, 11.50it/s] 74%|███████▎  | 618/840 [00:53<00:19, 11.55it/s] 74%|███████▍  | 620/840 [00:53<00:19, 11.55it/s] 74%|███████▍  | 622/840 [00:53<00:18, 11.50it/s] 74%|███████▍  | 624/840 [00:54<00:18, 11.46it/s] 75%|███████▍  | 626/840 [00:54<00:18, 11.49it/s] 75%|███████▍  | 628/840 [00:54<00:18, 11.36it/s] 75%|███████▌  | 630/840 [00:54<00:18, 11.37it/s] 75%|███████▌  | 632/840 [00:54<00:18, 11.47it/s] 75%|███████▌  | 634/840 [00:55<00:17, 11.47it/s] 76%|███████▌  | 636/840 [00:55<00:17, 11.54it/s] 76%|███████▌  | 638/840 [00:55<00:17, 11.58it/s] 76%|███████▌  | 640/840 [00:55<00:17, 11.51it/s] 76%|███████▋  | 642/840 [00:55<00:17, 11.46it/s] 77%|███████▋  | 644/840 [00:55<00:17, 11.48it/s]                                                  77%|███████▋  | 644/840 [00:55<00:17, 11.48it/s] 77%|███████▋  | 646/840 [00:56<00:17, 11.37it/s] 77%|███████▋  | 648/840 [00:56<00:16, 11.29it/s] 77%|███████▋  | 650/840 [00:56<00:16, 11.37it/s] 78%|███████▊  | 652/840 [00:56<00:16, 11.38it/s] 78%|███████▊  | 654/840 [00:56<00:16, 11.41it/s] 78%|███████▊  | 656/840 [00:56<00:16, 11.39it/s] 78%|███████▊  | 658/840 [00:57<00:15, 11.38it/s] 79%|███████▊  | 660/840 [00:57<00:15, 11.44it/s] 79%|███████▉  | 662/840 [00:57<00:15, 11.42it/s] 79%|███████▉  | 664/840 [00:57<00:15, 11.49it/s] 79%|███████▉  | 666/840 [00:57<00:15, 11.51it/s] 80%|███████▉  | 668/840 [00:58<00:14, 11.53it/s] 80%|███████▉  | 670/840 [00:58<00:14, 11.53it/s] 80%|████████  | 672/840 [00:58<00:14, 11.53it/s]                                                  80%|████████  | 672/840 [00:58<00:14, 11.53it/s] 80%|████████  | 674/840 [00:58<00:14, 11.53it/s] 80%|████████  | 676/840 [00:58<00:14, 11.49it/s] 81%|████████  | 678/840 [00:58<00:14, 11.51it/s] 81%|████████  | 680/840 [00:59<00:13, 11.51it/s] 81%|████████  | 682/840 [00:59<00:13, 11.47it/s] 81%|████████▏ | 684/840 [00:59<00:13, 11.43it/s] 82%|████████▏ | 686/840 [00:59<00:13, 11.40it/s] 82%|████████▏ | 688/840 [00:59<00:13, 11.35it/s] 82%|████████▏ | 690/840 [00:59<00:13, 11.41it/s] 82%|████████▏ | 692/840 [01:00<00:12, 11.50it/s] 83%|████████▎ | 694/840 [01:00<00:12, 11.57it/s] 83%|████████▎ | 696/840 [01:00<00:12, 11.44it/s] 83%|████████▎ | 698/840 [01:00<00:12, 11.45it/s] 83%|████████▎ | 700/840 [01:00<00:12, 11.51it/s]                                                  83%|████████▎ | 700/840 [01:00<00:12, 11.51it/s] 84%|████████▎ | 702/840 [01:00<00:11, 11.51it/s] 84%|████████▍ | 704/840 [01:01<00:11, 11.49it/s] 84%|████████▍ | 706/840 [01:01<00:11, 11.53it/s] 84%|████████▍ | 708/840 [01:01<00:11, 11.49it/s] 85%|████████▍ | 710/840 [01:01<00:11, 11.56it/s] 85%|████████▍ | 712/840 [01:01<00:11, 11.54it/s] 85%|████████▌ | 714/840 [01:02<00:10, 11.49it/s] 85%|████████▌ | 716/840 [01:02<00:10, 11.39it/s] 85%|████████▌ | 718/840 [01:02<00:10, 11.44it/s] 86%|████████▌ | 720/840 [01:02<00:10, 11.48it/s] 86%|████████▌ | 722/840 [01:02<00:10, 11.50it/s] 86%|████████▌ | 724/840 [01:02<00:10, 11.43it/s] 86%|████████▋ | 726/840 [01:03<00:09, 11.46it/s] 87%|████████▋ | 728/840 [01:03<00:09, 11.47it/s]                                                  87%|████████▋ | 728/840 [01:03<00:09, 11.47it/s] 87%|████████▋ | 730/840 [01:03<00:09, 11.47it/s] 87%|████████▋ | 732/840 [01:03<00:09, 11.43it/s] 87%|████████▋ | 734/840 [01:03<00:09, 11.47it/s] 88%|████████▊ | 736/840 [01:03<00:09, 11.43it/s] 88%|████████▊ | 738/840 [01:04<00:08, 11.46it/s] 88%|████████▊ | 740/840 [01:04<00:08, 11.53it/s] 88%|████████▊ | 742/840 [01:04<00:08, 11.44it/s] 89%|████████▊ | 744/840 [01:04<00:08, 11.48it/s] 89%|████████▉ | 746/840 [01:04<00:08, 11.49it/s] 89%|████████▉ | 748/840 [01:04<00:08, 11.47it/s] 89%|████████▉ | 750/840 [01:05<00:07, 11.48it/s] 90%|████████▉ | 752/840 [01:05<00:07, 11.43it/s] 90%|████████▉ | 754/840 [01:05<00:07, 11.45it/s] 90%|█████████ | 756/840 [01:05<00:07, 11.43it/s]                                                  90%|█████████ | 756/840 [01:05<00:07, 11.43it/s] 90%|█████████ | 758/840 [01:05<00:07, 11.41it/s] 90%|█████████ | 760/840 [01:06<00:06, 11.46it/s] 91%|█████████ | 762/840 [01:06<00:06, 11.44it/s] 91%|█████████ | 764/840 [01:06<00:06, 11.42it/s] 91%|█████████ | 766/840 [01:06<00:06, 11.45it/s] 91%|█████████▏| 768/840 [01:06<00:06, 11.52it/s] 92%|█████████▏| 770/840 [01:06<00:06, 11.46it/s] 92%|█████████▏| 772/840 [01:07<00:05, 11.48it/s] 92%|█████████▏| 774/840 [01:07<00:05, 11.47it/s] 92%|█████████▏| 776/840 [01:07<00:05, 11.40it/s] 93%|█████████▎| 778/840 [01:07<00:05, 11.40it/s] 93%|█████████▎| 780/840 [01:07<00:05, 11.45it/s] 93%|█████████▎| 782/840 [01:07<00:05, 11.46it/s] 93%|█████████▎| 784/840 [01:08<00:04, 11.58it/s]                                                  93%|█████████▎| 784/840 [01:08<00:04, 11.58it/s] 94%|█████████▎| 786/840 [01:08<00:04, 11.51it/s] 94%|█████████▍| 788/840 [01:08<00:04, 11.60it/s] 94%|█████████▍| 790/840 [01:08<00:04, 11.51it/s] 94%|█████████▍| 792/840 [01:08<00:04, 11.56it/s] 95%|█████████▍| 794/840 [01:08<00:03, 11.57it/s] 95%|█████████▍| 796/840 [01:09<00:03, 11.51it/s] 95%|█████████▌| 798/840 [01:09<00:03, 11.52it/s] 95%|█████████▌| 800/840 [01:09<00:03, 11.48it/s] 95%|█████████▌| 802/840 [01:09<00:03, 11.49it/s] 96%|█████████▌| 804/840 [01:09<00:03, 11.45it/s] 96%|█████████▌| 806/840 [01:10<00:02, 11.52it/s] 96%|█████████▌| 808/840 [01:10<00:02, 11.56it/s] 96%|█████████▋| 810/840 [01:10<00:02, 11.52it/s] 97%|█████████▋| 812/840 [01:10<00:02, 11.46it/s]                                                  97%|█████████▋| 812/840 [01:10<00:02, 11.46it/s] 97%|█████████▋| 814/840 [01:10<00:02, 11.42it/s] 97%|█████████▋| 816/840 [01:10<00:02, 11.44it/s] 97%|█████████▋| 818/840 [01:11<00:01, 11.38it/s] 98%|█████████▊| 820/840 [01:11<00:01, 11.39it/s] 98%|█████████▊| 822/840 [01:11<00:01, 11.39it/s] 98%|█████████▊| 824/840 [01:11<00:01, 11.35it/s] 98%|█████████▊| 826/840 [01:11<00:01, 11.41it/s] 99%|█████████▊| 828/840 [01:11<00:01, 11.40it/s] 99%|█████████▉| 830/840 [01:12<00:00, 11.44it/s] 99%|█████████▉| 832/840 [01:12<00:00, 11.47it/s] 99%|█████████▉| 834/840 [01:12<00:00, 11.52it/s]100%|█████████▉| 836/840 [01:12<00:00, 11.56it/s]100%|█████████▉| 838/840 [01:12<00:00, 11.59it/s]100%|██████████| 840/840 [01:12<00:00, 11.52it/s]                                                 100%|██████████| 840/840 [01:12<00:00, 11.52it/s]                                                 100%|██████████| 840/840 [01:12<00:00, 11.52it/s]100%|██████████| 840/840 [01:13<00:00, 11.51it/s]
{'loss': 2.6274, 'learning_rate': 3.0952380952380957e-06, 'epoch': 1.0}
{'loss': 0.8175, 'learning_rate': 6.4285714285714295e-06, 'epoch': 2.0}
{'loss': 0.6992, 'learning_rate': 9.761904761904762e-06, 'epoch': 3.0}
{'loss': 0.6726, 'learning_rate': 1.3095238095238096e-05, 'epoch': 4.0}
{'loss': 0.6009, 'learning_rate': 1.642857142857143e-05, 'epoch': 5.0}
{'loss': 0.5351, 'learning_rate': 1.9761904761904763e-05, 'epoch': 6.0}
{'loss': 0.4341, 'learning_rate': 1.922619047619048e-05, 'epoch': 7.0}
{'loss': 0.3093, 'learning_rate': 1.8392857142857142e-05, 'epoch': 8.0}
{'loss': 0.25, 'learning_rate': 1.755952380952381e-05, 'epoch': 9.0}
{'loss': 0.1662, 'learning_rate': 1.672619047619048e-05, 'epoch': 10.0}
{'loss': 0.1539, 'learning_rate': 1.5892857142857142e-05, 'epoch': 11.0}
{'loss': 0.1153, 'learning_rate': 1.5059523809523811e-05, 'epoch': 12.0}
{'loss': 0.0735, 'learning_rate': 1.4226190476190478e-05, 'epoch': 13.0}
{'loss': 0.0828, 'learning_rate': 1.3392857142857142e-05, 'epoch': 14.0}
{'loss': 0.0692, 'learning_rate': 1.2559523809523811e-05, 'epoch': 15.0}
{'loss': 0.0437, 'learning_rate': 1.1726190476190478e-05, 'epoch': 16.0}
{'loss': 0.0246, 'learning_rate': 1.0892857142857142e-05, 'epoch': 17.0}
{'loss': 0.0185, 'learning_rate': 1.005952380952381e-05, 'epoch': 18.0}
{'loss': 0.0321, 'learning_rate': 9.226190476190477e-06, 'epoch': 19.0}
{'loss': 0.0235, 'learning_rate': 8.422619047619049e-06, 'epoch': 20.0}
{'loss': 0.0214, 'learning_rate': 7.589285714285714e-06, 'epoch': 21.0}
{'loss': 0.0042, 'learning_rate': 6.755952380952382e-06, 'epoch': 22.0}
{'loss': 0.008, 'learning_rate': 5.922619047619048e-06, 'epoch': 23.0}
{'loss': 0.0064, 'learning_rate': 5.0892857142857146e-06, 'epoch': 24.0}
{'loss': 0.0054, 'learning_rate': 4.255952380952381e-06, 'epoch': 25.0}
{'loss': 0.0131, 'learning_rate': 3.422619047619048e-06, 'epoch': 26.0}
{'loss': 0.014, 'learning_rate': 2.5892857142857148e-06, 'epoch': 27.0}
{'loss': 0.0106, 'learning_rate': 1.755952380952381e-06, 'epoch': 28.0}
{'loss': 0.012, 'learning_rate': 9.226190476190477e-07, 'epoch': 29.0}
{'loss': 0.0052, 'learning_rate': 8.928571428571429e-08, 'epoch': 30.0}
{'train_runtime': 73.0009, 'train_samples_per_second': 367.393, 'train_steps_per_second': 11.507, 'train_loss': 0.26166031911437, 'epoch': 30.0}

Train time: 73.09210062026978 

  0%|          | 0/107 [00:00<?, ?it/s]  2%|▏         | 2/107 [00:00<00:05, 18.98it/s]  4%|▎         | 4/107 [00:00<00:08, 11.51it/s]  6%|▌         | 6/107 [00:00<00:09, 10.13it/s]  7%|▋         | 8/107 [00:00<00:10,  9.79it/s]  9%|▉         | 10/107 [00:00<00:09, 10.08it/s] 11%|█         | 12/107 [00:01<00:09,  9.72it/s] 13%|█▎        | 14/107 [00:01<00:09, 10.02it/s] 15%|█▍        | 16/107 [00:01<00:09,  9.66it/s] 17%|█▋        | 18/107 [00:01<00:08, 10.12it/s] 19%|█▊        | 20/107 [00:01<00:08,  9.72it/s] 20%|█▉        | 21/107 [00:02<00:08,  9.65it/s] 21%|██▏       | 23/107 [00:02<00:08,  9.69it/s] 23%|██▎       | 25/107 [00:02<00:08,  9.86it/s] 24%|██▍       | 26/107 [00:02<00:10,  7.96it/s] 25%|██▌       | 27/107 [00:02<00:10,  7.92it/s] 26%|██▌       | 28/107 [00:02<00:09,  8.31it/s] 28%|██▊       | 30/107 [00:03<00:08,  8.84it/s] 29%|██▉       | 31/107 [00:03<00:08,  8.89it/s] 30%|██▉       | 32/107 [00:03<00:08,  8.97it/s] 31%|███       | 33/107 [00:03<00:08,  8.59it/s] 32%|███▏      | 34/107 [00:03<00:08,  8.47it/s] 33%|███▎      | 35/107 [00:03<00:08,  8.80it/s] 34%|███▎      | 36/107 [00:03<00:07,  9.00it/s] 35%|███▍      | 37/107 [00:03<00:07,  9.01it/s] 36%|███▌      | 38/107 [00:04<00:07,  8.83it/s] 36%|███▋      | 39/107 [00:04<00:07,  8.66it/s] 37%|███▋      | 40/107 [00:04<00:08,  8.30it/s] 38%|███▊      | 41/107 [00:04<00:07,  8.33it/s] 39%|███▉      | 42/107 [00:04<00:07,  8.76it/s] 40%|████      | 43/107 [00:04<00:07,  9.03it/s] 41%|████      | 44/107 [00:04<00:06,  9.12it/s] 43%|████▎     | 46/107 [00:04<00:06,  9.42it/s] 44%|████▍     | 47/107 [00:05<00:06,  9.41it/s] 45%|████▍     | 48/107 [00:05<00:06,  9.56it/s] 46%|████▌     | 49/107 [00:05<00:06,  9.66it/s] 47%|████▋     | 50/107 [00:05<00:06,  9.48it/s] 48%|████▊     | 51/107 [00:05<00:05,  9.60it/s] 50%|████▉     | 53/107 [00:05<00:05,  9.84it/s] 51%|█████▏    | 55/107 [00:05<00:05,  9.64it/s] 52%|█████▏    | 56/107 [00:05<00:05,  9.41it/s] 53%|█████▎    | 57/107 [00:06<00:05,  9.28it/s] 54%|█████▍    | 58/107 [00:06<00:05,  9.05it/s] 55%|█████▌    | 59/107 [00:06<00:05,  9.22it/s] 56%|█████▌    | 60/107 [00:06<00:05,  9.29it/s] 57%|█████▋    | 61/107 [00:06<00:05,  9.17it/s] 58%|█████▊    | 62/107 [00:06<00:04,  9.23it/s] 59%|█████▉    | 63/107 [00:06<00:04,  8.98it/s] 60%|█████▉    | 64/107 [00:06<00:04,  8.64it/s] 61%|██████    | 65/107 [00:07<00:04,  8.50it/s] 62%|██████▏   | 66/107 [00:07<00:04,  8.58it/s] 64%|██████▎   | 68/107 [00:07<00:04,  9.51it/s] 64%|██████▍   | 69/107 [00:07<00:04,  9.27it/s] 65%|██████▌   | 70/107 [00:07<00:04,  7.60it/s] 66%|██████▋   | 71/107 [00:07<00:04,  7.98it/s] 67%|██████▋   | 72/107 [00:07<00:04,  8.25it/s] 68%|██████▊   | 73/107 [00:07<00:04,  7.88it/s] 70%|███████   | 75/107 [00:08<00:03,  9.10it/s] 71%|███████   | 76/107 [00:08<00:03,  8.59it/s] 72%|███████▏  | 77/107 [00:08<00:03,  8.88it/s] 73%|███████▎  | 78/107 [00:08<00:03,  9.05it/s] 74%|███████▍  | 79/107 [00:08<00:03,  9.23it/s] 75%|███████▍  | 80/107 [00:08<00:03,  8.70it/s] 77%|███████▋  | 82/107 [00:08<00:02,  9.60it/s] 79%|███████▊  | 84/107 [00:09<00:02,  9.42it/s] 80%|████████  | 86/107 [00:09<00:02,  9.62it/s] 81%|████████▏ | 87/107 [00:09<00:02,  9.66it/s] 82%|████████▏ | 88/107 [00:09<00:01,  9.72it/s] 83%|████████▎ | 89/107 [00:09<00:02,  8.80it/s] 84%|████████▍ | 90/107 [00:09<00:01,  8.82it/s] 85%|████████▌ | 91/107 [00:09<00:01,  8.34it/s] 86%|████████▌ | 92/107 [00:10<00:01,  8.68it/s] 88%|████████▊ | 94/107 [00:10<00:01,  9.67it/s] 89%|████████▉ | 95/107 [00:10<00:01,  9.53it/s] 90%|████████▉ | 96/107 [00:10<00:01,  9.58it/s] 91%|█████████ | 97/107 [00:10<00:01,  9.55it/s] 92%|█████████▏| 98/107 [00:10<00:00,  9.61it/s] 93%|█████████▎| 99/107 [00:10<00:00,  9.23it/s] 93%|█████████▎| 100/107 [00:10<00:00,  9.04it/s] 94%|█████████▍| 101/107 [00:10<00:00,  9.05it/s] 95%|█████████▌| 102/107 [00:11<00:00,  8.75it/s] 97%|█████████▋| 104/107 [00:11<00:00,  8.89it/s] 99%|█████████▉| 106/107 [00:11<00:00,  9.37it/s]100%|██████████| 107/107 [00:11<00:00,  9.10it/s]
Highest probability prediction per premise:  [3, 0, 1, 2, 2, 3, 2, 3, 3, 1, 2, 0, 2, 2, 1, 3, 3, 1, 0, 2]
Correct labels per premise:  [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]
Aggregate metrics:  {'f1_macro': 0.4764188531514456, 'f1_micro': 0.7262956419316844, 'accuracy_balanced': 0.5300012790706339, 'accuracy_not_b': 0.7262956419316844, 'precision_macro': 0.47037749848285526, 'recall_macro': 0.5300012790706339, 'precision_micro': 0.7262956419316844, 'recall_micro': 0.7262956419316844}
Detailed metrics:  {'neutral': {'precision': 0.0694980694980695, 'recall': 0.18461538461538463, 'f1-score': 0.10098176718092568, 'support': 195}, 'no_topic': {'precision': 0.9234786557674841, 'recall': 0.8134, 'f1-score': 0.864951084644832, 'support': 5000}, 'sceptical': {'precision': 0.31449893390191896, 'recall': 0.6555555555555556, 'f1-score': 0.4250720461095101, 'support': 450}, 'supportive': {'precision': 0.5740343347639485, 'recall': 0.4664341761115955, 'f1-score': 0.5146705146705147, 'support': 1147}, 'accuracy': 0.7262956419316844, 'macro avg': {'precision': 0.47037749848285526, 'recall': 0.5300012790706339, 'f1-score': 0.4764188531514456, 'support': 6792}, 'weighted avg': {'precision': 0.799600604331516, 'recall': 0.7262956419316844, 'f1-score': 0.7547197245142521, 'support': 6792}} 


Test results:
{'eval_loss': 2.607661485671997, 'eval_f1_macro': 0.4764188531514456, 'eval_f1_micro': 0.7262956419316844, 'eval_accuracy_balanced': 0.5300012790706339, 'eval_accuracy_not_b': 0.7262956419316844, 'eval_precision_macro': 0.47037749848285526, 'eval_recall_macro': 0.5300012790706339, 'eval_precision_micro': 0.7262956419316844, 'eval_recall_micro': 0.7262956419316844, 'eval_runtime': 11.8707, 'eval_samples_per_second': 2288.657, 'eval_steps_per_second': 9.014, 'epoch': 30.0}

Script done.


